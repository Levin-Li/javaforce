<project name="native" default="linux" basedir=".">
  <description>native</description>
  <property environment="env"/>

  <target name="javah">
    <javah destdir="." classpath="../../classes">
      <class name="javaforce.gl.GL"/>
      <class name="javaforce.media.Camera"/>
      <class name="javaforce.media.MediaCoder"/>
      <class name="javaforce.media.MediaDecoder"/>
      <class name="javaforce.media.MediaEncoder"/>
      <class name="javaforce.media.MediaVideoDecoder"/>
      <class name="javaforce.jni.LnxNative"/>
    </javah>
  </target>

  <target name="linux" depends="javah"  description="create linux native so">

    <exec command="gcc -D_FILE_OFFSET_BITS=64 -I ${env.JAVA_HOME}/include -I ${env.JAVA_HOME}/include/linux linux.cpp -c -o linux64.o -fPIC"/>
    <exec command="gcc -I../glfw/include glfw.c -c -o glfs64.o -fPIC"/>
    <exec command="gcc -shared linux64.o glfw64.o -lX11 -lpam -o ../jfnative64.so"/>
    <delete>
      <fileset dir="." includes="*.o"/>
    </delete>

    <exec command="gcc -m32 -D_FILE_OFFSET_BITS=64 -I ${env.JAVA_HOME}/include -I ${env.JAVA_HOME}/include/linux linux.cpp -c -o linux32.o -fPIC"/>
    <exec command="gcc -m32 -I../glfw/include glfw.c -c -o glfs32.o -fPIC"/>
    <exec command="gcc -m32 -shared linux32.o glfw32.o -lX11 -lpam -o ../jfnative32.so"/>
    <delete>
      <fileset dir="." includes="*.o"/>
    </delete>

  </target>
</project>
